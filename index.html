<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
</head>
<body>
    <div class="text-center mt-4">
        <h4>Database Alumni IKM Wastra</h4>
        <p>Balai Pemberdayaan Industri Fesyen dan Kriya</p>
    </div>
    <hr>
    <div class="container mt-4 mb-5">
    <div class="card shadow-sm">
        <div class="card-body">
            <form id="formIKM">
                <h5 class="fw-bold text-primary">Data Umum</h5>
                <!-- NO -->
                <div class="row mb-3">
                    <label for="no" class="col-md-4 col-form-label">No</label>
                    <div class="col-md-8">
                        <input type="text" class="form-control" id="no">
                    </div>
                </div>

                <!-- EMAIL -->
                <div class="row mb-3">
                    <label for="email" class="col-md-4 col-form-label">Email</label>
                    <div class="col-md-8">
                        <input type="email" class="form-control" id="email">
                    </div>
                </div>

                <!-- NAMA PEMILIK (ADA SEARCH) -->
                <div class="row mb-3">
                    <label for="nama" class="col-md-4 col-form-label">Nama Pemilik</label>
                    <div class="col-md-8">
                        <div class="input-group">
                            <input type="text" class="form-control" id="nama">
                            <button class="btn btn-primary" type="button" id="btnCari">
                                Cari
                            </button>
                        </div>
                    </div>
                </div>

                <!-- NAMA BRAND -->
                <div class="row mb-3">
                    <label for="nama_brand" class="col-md-4 col-form-label">Nama Brand / IKM</label>
                    <div class="col-md-8">
                        <input type="text" class="form-control" id="nama_brand">
                    </div>
                </div>

                <!-- NO TELEPON -->
                <div class="row mb-3">
                    <label for="no_telepon" class="col-md-4 col-form-label">No Telepon</label>
                    <div class="col-md-8">
                        <input type="text" class="form-control" id="no_telepon">
                    </div>
                </div>

                <!-- PROGRAM -->
                <div class="row mb-3">
                    <label for="program" class="col-md-4 col-form-label">Program yang Diikuti</label>
                    <div class="col-md-8">
                        <input type="text" class="form-control" id="program">
                    </div>
                </div>

                <!-- TAHUN IKUT -->
                <div class="row mb-3">
                    <label for="tahun_ikut" class="col-md-4 col-form-label">Tahun Ikut Program</label>
                    <div class="col-md-8">
                        <input type="number" class="form-control" id="tahun_ikut">
                    </div>
                </div>

                <!-- DESKRIPSI -->
                <div class="row mb-3">
                    <label for="deskripsi_ikm" class="col-md-4 col-form-label">Deskripsi IKM</label>
                    <div class="col-md-8">
                        <textarea class="form-control" id="deskripsi_ikm"></textarea>
                    </div>
                </div>

                <!-- ALAMAT USAHA -->
                <div class="row mb-3">
                    <label for="alamat_usaha" class="col-md-4 col-form-label">Alamat Usaha</label>
                    <div class="col-md-8">
                        <textarea class="form-control" id="alamat_usaha"></textarea>
                    </div>
                </div>
                <!-- LEGALITAS -->
                <hr class="my-4">
                <h5 class="fw-bold text-primary">Legalitas & Profil Usaha</h5>

                <div class="row mb-3">
                    <label for="bentuk_usaha" class="col-md-4 col-form-label">Bentuk Usaha</label>
                    <div class="col-md-8">
                        <input type="text" id="bentuk_usaha" class="form-control">
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="tahun_berdiri" class="col-md-4 col-form-label">Tahun Berdiri</label>
                    <div class="col-md-8">
                        <input type="number" id="tahun_berdiri" class="form-control">
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="pemilik_nib" class="col-md-4 col-form-label">Kepemilikan NIB</label>
                    <div class="col-md-8">
                        <input type="text" id="pemilik_nib" class="form-control">
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="kbli_nib" class="col-md-4 col-form-label">KBLI pada NIB</label>
                    <div class="col-md-8">
                        <input type="text" id="kbli_nib" class="form-control">
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="siinas" class="col-md-4 col-form-label">SIINas</label>
                    <div class="col-md-8">
                        <input type="text" id="siinas" class="form-control">
                    </div>
                </div>
                <hr class="my-4">
                <h5 class="fw-bold text-primary">Produk & Sertifikasi</h5>

                <div class="row mb-3">
                    <label for="sertifikasi_dimiliki" class="col-md-4 col-form-label">Sertifikasi yang Dimiliki</label>
                    <div class="col-md-8">
                        <textarea id="sertifikasi_dimiliki" class="form-control" rows="2"></textarea>
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="standarisasi" class="col-md-4 col-form-label">Standarisasi yang Dimiliki</label>
                    <div class="col-md-8">
                        <textarea id="standarisasi" class="form-control" rows="2"></textarea>
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="daftar_sku" class="col-md-4 col-form-label">Daftar SKU yang Dimiliki</label>
                    <div class="col-md-8">
                        <textarea id="daftar_sku" class="form-control" rows="2"></textarea>
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="spesialisasi_produk" class="col-md-4 col-form-label">Spesialisasi Produk</label>
                    <div class="col-md-8">
                        <input type="text" id="spesialisasi_produk" class="form-control">
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="produk_unggulan" class="col-md-4 col-form-label">Produk Unggulan</label>
                    <div class="col-md-8">
                        <input type="text" id="produk_unggulan" class="form-control">
                    </div>
                </div>

                <!-- link FOTO -->
                <div class="row mb-3">
                    <label for="link_foto_produk" class="col-md-4 col-form-label">Link Foto Produk Unggulan</label>
                    <div class="col-md-8">
                        <input type="url" id="link_foto_produk" class="form-control">
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="link_foto_owner" class="col-md-4 col-form-label">Link Foto Owner</label>
                    <div class="col-md-8">
                        <input type="url" id="link_foto_owner" class="form-control">
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="link_foto_logo" class="col-md-4 col-form-label">Link Foto Logo IKM</label>
                    <div class="col-md-8">
                        <input type="url" id="link_foto_logo" class="form-control">
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="rentang_harga" class="col-md-4 col-form-label">Rentang Harga Produk</label>
                    <div class="col-md-8">
                        <input type="text" id="rentang_harga" class="form-control">
                    </div>
                </div>

                <!-- PRODUK -->
                <div class="row mb-3">
                    <label for="kapasitas_perbulan" class="col-md-4 col-form-label">
                        Kapasitas Produksi Rata-rata per Bulan
                    </label>
                    <div class="col-md-8">
                        <input type="text" id="kapasitas_perbulan" class="form-control">
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="omset_2025" class="col-md-4 col-form-label">
                        Omset Tahunan pada Tahun 2025
                    </label>
                    <div class="col-md-8">
                        <input type="text" id="omset_2025" class="form-control">
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="sistem_pemesanan" class="col-md-4 col-form-label">
                        Sistem Pemesanan Produk
                    </label>
                    <div class="col-md-8">
                        <textarea id="sistem_pemesanan" class="form-control" rows="2"></textarea>
                    </div>
                </div>
                <!-- MINIMAL ORDER -->
                <div class="row mb-3">
                    <label for="minimal_order" class="col-md-4 col-form-label">
                        Jika menerima custom, berapa minimal pemesanannya (MOQ) ?
                    </label>
                    <div class="col-md-8">
                        <input type="text" id="minimal_order" class="form-control">
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="lama_pengerjaan" class="col-md-4 col-form-label">
                        Jika menerima custom, berapa lama rata-rata pengerjaannya?
                    </label>
                    <div class="col-md-8">
                        <input type="text" id="lama_pengerjaan" class="form-control">
                    </div>
                </div>
                <!-- TENAGA KERJA -->
                <div class="row mb-3">
                    <label for="tenaga_tetap" class="col-md-4 col-form-label">
                        Jumlah Tenaga Kerja Tetap
                    </label>
                    <div class="col-md-8">
                        <input type="number" id="tenaga_tetap" class="form-control">
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="tenaga_freelance" class="col-md-4 col-form-label">
                        Jumlah Tenaga Kerja Tidak Tetap/Freelance
                    </label>
                    <div class="col-md-8">
                        <input type="number" id="tenaga_freelance" class="form-control">
                    </div>
                </div>
                <!-- PEMASARAN DAN EXPOR -->
                <hr class="my-4">
                <h5 class="fw-bold text-primary">Pemasaran & Ekspor</h5>

                <div class="row mb-3">
                    <label for="penjualan_produk" class="col-md-4 col-form-label">Penjualan Produk</label>
                    <div class="col-md-8">
                        <textarea id="penjualan_produk" class="form-control" rows="2"></textarea>
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="instagram" class="col-md-4 col-form-label">Instagram</label>
                    <div class="col-md-8">
                        <input type="url" id="instagram" class="form-control">
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="tiktok" class="col-md-4 col-form-label">Tiktok</label>
                    <div class="col-md-8">
                        <input type="url" id="tiktok" class="form-control">
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="website" class="col-md-4 col-form-label">Website</label>
                    <div class="col-md-8">
                        <input type="url" id="website" class="form-control">
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="shopee" class="col-md-4 col-form-label">Shopee</label>
                    <div class="col-md-8">
                        <input type="url" id="shopee" class="form-control">
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="tokopedia" class="col-md-4 col-form-label">Tokopedia</label>
                    <div class="col-md-8">
                        <input type="url" id="tokopedia" class="form-control">
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="status_ekspor" class="col-md-4 col-form-label">Status Ekspor</label>
                    <div class="col-md-8">
                        <input type="text" id="status_ekspor" class="form-control">
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="negara_tujuan" class="col-md-4 col-form-label">Negara Tujuan Ekspor</label>
                    <div class="col-md-8">
                        <input type="text" id="negara_tujuan" class="form-control">
                    </div>
                </div>
                <!-- TOMBOL SIMPAN -->
                <div class="row mt-4">
                    <div class="col-md-4"></div>
                    <div class="col-md-8">
                        <button type="button" class="btn btn-success w-10" id="btnSimpan">
                            Simpan Data
                        </button>
                    </div>
                </div>

            </form>
        </div>
    </div>
</div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
    
    <!-- Cari -->
    <script>
        async function cariData() {

        const nama = document.getElementById("nama").value;

        if (!nama) {
            alert("Masukkan nama terlebih dahulu");
            return;
        }

        const url = "https://script.google.com/macros/s/AKfycbwaBVdxMUylIhr4_MVBqD8xSOkeQwwPKN_7ULUCwwDiUD9M2XMkXt5Q-9v4QrSYBQh-/exec?nama=" + encodeURIComponent(nama);

        try {
            const response = await fetch(url);
            const data = await response.json();

            if (data.error) {
            alert(data.error);
            return;
            }

            //Auto isi semua field
            for (let key in data) {
            const element = document.getElementById(key);
            if (element) {
                element.value = data[key] || "";
            }
            }

        } catch (error) {
            alert("Gagal mengambil data");
            console.error(error);
        }
        }
    </script>

    <script>
    document.getElementById("btnCari").addEventListener("click", cariData);
    </script>

    <!-- Script untuk menyimpan update data ke Google Sheets -->
    <script>
        async function simpanData() {

        const inputs = document.querySelectorAll("input, textarea, select");

        let formData = {};

        inputs.forEach(input => {
            if (input.id) {
            formData[input.id] = input.value;
            }
        });

        const formBody = new URLSearchParams(formData).toString();

        try {
            await fetch("https://script.google.com/macros/s/AKfycbwaBVdxMUylIhr4_MVBqD8xSOkeQwwPKN_7ULUCwwDiUD9M2XMkXt5Q-9v4QrSYBQh-/exec", {
            method: "POST",
            mode: "no-cors",
            headers: {
                "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8"
            },
            body: formBody
            });

            alert("Data berhasil dikirim.");

        } catch (error) {
            alert("Gagal menyimpan data");
            console.error(error);
        }
        }

        document.getElementById("btnSimpan")
        .addEventListener("click", simpanData);
    </script>
</body>
</html>